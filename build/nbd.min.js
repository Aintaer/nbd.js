(function(t){var n,e,i;(function(t){function r(t,n){return m.call(t,n)}function o(t,n){var e,i,r,o,s,u,c,f,a,l,p=n&&n.split("/"),h=v.map,d=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(n){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),f=0;t.length>f;f+=1)if(l=t[f],"."===l)t.splice(f,1),f-=1;else if(".."===l){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||d)&&h){for(e=t.split("/"),f=e.length;f>0;f-=1){if(i=e.slice(0,f).join("/"),p)for(a=p.length;a>0;a-=1)if(r=h[p.slice(0,a).join("/")],r&&(r=r[i])){o=r,s=f;break}if(o)break;!u&&d&&d[i]&&(u=d[i],c=f)}!o&&u&&(o=u,s=c),o&&(e.splice(0,s,o),t=e.join("/"))}return t}function s(n,e){return function(){return h.apply(t,_.call(arguments,0).concat([n,e]))}}function u(t){return function(n){return o(n,t)}}function c(t){return function(n){b[t]=n}}function f(n){if(r(w,n)){var e=w[n];delete w[n],g[n]=!0,p.apply(t,e)}if(!r(b,n)&&!r(g,n))throw Error("No "+n);return b[n]}function a(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function l(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,h,d,y,b={},w={},v={},g={},m=Object.prototype.hasOwnProperty,_=[].slice;d=function(t,n){var e,i=a(t),r=i[0];return t=i[1],r&&(r=o(r,n),e=f(r)),r?t=e&&e.normalize?e.normalize(t,u(n)):o(t,n):(t=o(t,n),i=a(t),r=i[0],t=i[1],r&&(e=f(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:e}},y={require:function(t){return s(t)},exports:function(t){var n=b[t];return n!==void 0?n:b[t]={}},module:function(t){return{id:t,uri:"",exports:b[t],config:l(t)}}},p=function(n,e,i,o){var u,a,l,p,h,v,m=[];if(o=o||n,"function"==typeof i){for(e=!e.length&&i.length?["require","exports","module"]:e,h=0;e.length>h;h+=1)if(p=d(e[h],o),a=p.f,"require"===a)m[h]=y.require(n);else if("exports"===a)m[h]=y.exports(n),v=!0;else if("module"===a)u=m[h]=y.module(n);else if(r(b,a)||r(w,a)||r(g,a))m[h]=f(a);else{if(!p.p)throw Error(n+" missing "+a);p.p.load(p.n,s(o,!0),c(a),{}),m[h]=b[a]}l=i.apply(b[n],m),n&&(u&&u.exports!==t&&u.exports!==b[n]?b[n]=u.exports:l===t&&v||(b[n]=l))}else n&&(b[n]=i)},n=e=h=function(n,e,i,r,o){return"string"==typeof n?y[n]?y[n](e):f(d(n,e).f):(n.splice||(v=n,e.splice?(n=e,e=i,i=null):n=t),e=e||function(){},"function"==typeof i&&(i=r,r=o),r?p(t,n,e,i):setTimeout(function(){p(t,n,e,i)},15),h)},h.config=function(t){return v=t,h},i=function(t,n,e){n.splice||(e=n,n=[]),r(b,t)||r(w,t)||(w[t]=[t,n,e])},i.amd={jQuery:!0}})(),i("vendor/almond/almond",function(){}),i("nbd/Class",[],function(){var t,n,e,i=!1,r=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return e=function(t){var n,e={};for(n in t)t.hasOwnProperty(n)&&(e[n]={value:t[n]});return Object.defineProperties(this.prototype,e),this},n=function(t){var n,e=!1;if("function"==typeof t)return t.prototype.isPrototypeOf(this.prototype);if("object"==typeof t){e=!0;for(n in t)if(t.hasOwnProperty(n)&&t[n]!==this.prototype[n]){e=!1;break}}return e},t=function(){},t.inherits=n,t.extend=function o(t,n){function s(t,n,e){return function(){var i=this.hasOwnProperty("_super"),r=this._super;this._super=p[t],e&&this._super.apply(this,arguments);try{return n.apply(this,arguments)}catch(o){}finally{i&&(this._super=r)}}}function u(t,n){return function(){return t.apply(this,arguments),n.apply(this,arguments)}}function c(){i||"function"!=typeof this.init||this.init.apply(this,arguments)}var f,a,l,p=this.prototype;i=!0,f=new this,i=!1;for(a in t)t.hasOwnProperty(a)&&(l="init"===a&&!(n&&n.hasOwnProperty("_")&&n._),f[a]="function"==typeof t[a]&&"function"==typeof p[a]&&(l||r.test(t[a]))?s(a,t[a],l):t[a]);for(a in this)this.hasOwnProperty(a)&&(c[a]=this[a]);for(a in n)n.hasOwnProperty(a)&&(l="init"===a&&!(n&&n.hasOwnProperty("_")&&n._),c[a]=l&&"function"==typeof c[a]&&"function"==typeof n[a]?u(c[a],n[a]):n[a]);return c.prototype=f,c.prototype.constructor=c,c.extend=o,c.mixin=e,c.__super__=p,c},t}),i("nbd/util/async",[],function(){function t(t){i.push(t),window.postMessage(r,"*")}function n(t){if(t.source===window&&t.data===r&&(t.stopPropagation(),i.length>0)){var n=i.shift();n()}}var e,i=[],r="async-message",o="function"==typeof window.postMessage&&"function"==typeof window.addEventListener;return o&&window.addEventListener("message",n,!0),e=o?t:function(t){window.setTimeout(t,0)}}),i("nbd/util/extend",[],function(){return function(t){var n,e,i;for(n=1;arguments.length>n;++n){i=arguments[n];for(e in i)t[e]=i[e]}return t}}),i("nbd/util/diff",["nbd/util/extend"],function(t){function n(t,i){var r,o=!0;for(r in t){if(t[r]!==i[r])return!1;if(t[r]&&t.hasOwnProperty(r)&&"object"==typeof t[r]){if(e.indexOf(t[r])>=0)continue;try{e.push(t[r]),o=o&&n(i[r],t[r])}catch(s){}finally{e.pop()}}if(!o)return o}return o}var e=[];return function(e,i,r){var o,s={};if("object"!=typeof i||"object"!=typeof e||null===i||null===e)throw new TypeError("Arguments must be objects");i=t({},i);for(o in e)e.hasOwnProperty(o)&&((i[o]!==e[o]||"object"==typeof e[o]&&e[o]&&!n(e[o],i[o]))&&(s[o]=[e[o],i[o]],r&&r.apply(this,[o,e[o],i[o]])),delete i[o]);for(o in i)i.hasOwnProperty(o)&&(s[o]=[e[o]],r&&r.apply(this,[o,,i[o]]));return s}}),i("nbd/trait/pubsub",[],function(){var t=/\s+/,n=function e(t){return e.i=e.i||0,(t||"")+ ++e.i};return{on:function(n,e,i){var r,o,s;if(!e)return this;for(n=n.split(t),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),r=this._callbacks;o=n.shift();)s=r[o]||(r[o]=[]),s.push(e,i);return this},off:function(n,e,i){var r,o,s,u;if(!(o=this._callbacks))return this;if(!(n||e||i))return delete this._callbacks,this;for(n=n?n.split(t):Object.keys(o);r=n.shift();)if((s=o[r])&&(e||i))for(u=s.length-2;u>=0;u-=2)e&&s[u]!==e||i&&s[u+1]!==i||s.splice(u,2);else delete o[r];return this},trigger:function(n){var e,i,r,o,s,u,c,f;if(!(i=this._callbacks))return this;for(f=[],n=n.split(t),o=1,s=arguments.length;s>o;o++)f[o-1]=arguments[o];for(;e=n.shift();){if((c=i.all)&&(c=c.slice()),(r=i[e])&&(r=r.slice()),r)for(o=0,s=r.length;s>o;o+=2)r[o].apply(r[o+1]||this,f);if(c)for(u=[e].concat(f),o=0,s=c.length;s>o;o+=2)c[o].apply(c[o+1]||this,u)}return this},listenTo:function(t,e,i){var r=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=n("l"));return r[o]=t,t.on(e,i||this,this),this},stopListening:function(t,n,e){var i=this._listeners;if(i){if(t)t.off(n,e,this),n||e||delete i[t._listenerId];else{for(var r in i)i[r].off(null,null,this);this._listeners={}}return this}}}}),i("nbd/Model",["nbd/Class","nbd/util/async","nbd/util/extend","nbd/util/diff","nbd/trait/pubsub"],function(t,n,e,i,r){var o=function(t,n){this._dirty&&(i.call(this,n||this._data,t,this.trigger),this._dirty=0)},s=t.extend({init:function(t,n){"string"==typeof t&&t.match(/^\d+$/)&&(t=+t),void 0===n&&(n=t),this.id=function(){return t};try{Object.defineProperty(this,"_dirty",{value:0,writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:n||{},writable:!0})}catch(e){this._dirty=0,this._data=n}},destroy:function(){this.off(null)},data:function(){return this._dirty++||n(o.bind(this,e({},this._data))),this._data},get:function(t){return this._data[t]},set:function(t,n){var e,i=this.data();if("string"==typeof t)return i[t]=n,this;if("object"==typeof t){for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return this}},toJSON:function(){return this._data}}).mixin(r);return s}),i("nbd/View",["nbd/Class"],function(t){var n=t.extend({$view:null,render:function(t){var n=this.$view;return this.$view=this.template(t||this.templateData()),n&&n.length&&n.replaceWith(this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null}});return n}),i("jquery",[],function(){return t.jQuery}),i("nbd/View/Entity",["jquery","nbd/View"],function(t,n){var e=n.extend({init:function(t){"object"==typeof t&&(this.Model=t),this.id=t&&t.id||function(){return t}},templateData:function(){return this.Model&&this.Model.data?this.Model.data():this.id()},render:function(n){var e=this.$view,i=!!e^!!n;if(i)"string"!=typeof e&&(this.$view=this.template(this.templateData()));else if(!e)return;if("string"!=typeof e||(this.$view=t(this.$view),i=!!n))return n?n.append(this.$view):e.replaceWith(this.$view),i&&"function"==typeof this.rendered&&this.rendered(),this.$view}});return e}),i("nbd/View/Element",["jquery","nbd/View"],function(t,n){var e=n.extend({$parent:null,init:function(t){this.$parent=t},render:function(n){var e=this.$view&&this.$view.length;return e||(this.$view=t("<div/>").appendTo(this.$parent)),this._super(n),this.$view}});return e}),i("nbd/util/construct",[],function(){var t=Object.prototype.toString;return function(){if(!(t.call(this).indexOf("Function")+1))throw new TypeError("construct called on incompatible Object");var n=Object.create(this.prototype),e=this.apply(n,arguments);return Object(e)===e?e:n}}),i("nbd/Controller",["nbd/Class","nbd/View","nbd/util/construct"],function(t,n,e){var i=t.extend({View:null,destroy:function(){},_initView:function(t){var n=Array.prototype.slice.call(arguments,1);(this.View=e.apply(t,n)).Controller=this},switchView:function(){var t=this.View;this._initView.apply(this,arguments),t&&(t.$view&&(this.View.$view=t.$view,this.View.render()),t.destroy())}});return i}),i("nbd/Controller/Entity",["nbd/util/construct","nbd/Controller","nbd/View/Entity","nbd/Model"],function(t,n,e,i){var r=n.extend({Model:null,init:function(){this.Model=t.apply(this.constructor.MODEL_CLASS,arguments),this._initView(this.constructor.VIEW_CLASS,this.Model)},render:function(t,n){n=n||this.constructor.VIEW_CLASS,this.requestView(n),this.View.render(t)},destroy:function(){this.View.destroy(),this.Model.destroy(),this.Model=this.View=null},requestView:function(t){this.View instanceof t||this.switchView(t,this.Model)}},{VIEW_CLASS:e,MODEL_CLASS:i});return r}),i("nbd/event",["nbd/util/extend","nbd/trait/pubsub"],function(t,n){var e=t({},n);return e.bind=e.on,e.unbind=e.off,e.fire=e.trigger,e}),i("nbd/trait/jquery.tmpl",["jquery"],function(t){return{template:function(){var t=this.templateScript();return t.tmpl.apply(t,arguments)},templateScript:function(n){if(n=n!==void 0?n:!0,this.constructor.$TEMPLATE&&this.constructor.$TEMPLATE.length||(this.constructor.$TEMPLATE=t("#"+this.constructor.TEMPLATE_ID)),!this.constructor.$TEMPLATE.length){if(n!==!0)return!1;t.error("Missing template: "+this.constructor.TEMPLATE_ID)}return this.constructor.$TEMPLATE}}}),i("nbd/util/deparam",[],function(){return function(t,n){var e={},i={"true":!0,"false":!1,"null":null};return t.replace(/\+/g," ").split("&").forEach(function(t){var r,o=t.split("="),s=decodeURIComponent(o[0]),u=e,c=0,f=s.split("]["),a=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[a])?(f[a]=f[a].replace(/\]$/,""),f=f.shift().split("[").concat(f),a=f.length-1):a=0,2===o.length)if(r=decodeURIComponent(o[1]),n&&(r=r&&!isNaN(r)?+r:"undefined"===r?void 0:void 0!==i[r]?i[r]:r),a)for(c;a>=c;c++)s=""===f[c]?u.length:f[c],u=u[s]=a>c?u[s]||(f[c+1]&&isNaN(f[c+1])?{}:[]):r;else Array.isArray(e[s])?e[s].push(r):e[s]=void 0!==e[s]?[e[s],r]:r;else s&&(e[s]=n?void 0:"")}),e}}),i("nbd/util/media",["nbd/util/extend","nbd/trait/pubsub"],function(t,n){function e(t,n){var e=window.matchMedia(n);s[t]=e,e.addListener(o.bind(e,t)),e.matches&&o.call(e,t)}function i(t){return s[t]&&s[t].matches}function r(t,n){var i;if(!u)throw Error("Media queries not supported.");if("string"==typeof t)return e(t,n),r;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(n=t[i],e(i,n));return r}var o,s={},u=window.matchMedia||window.msMatchMedia;return t(r,n),o=function(t){r.trigger(t+(this.matches?":enter":":exit")),r.trigger(t,this.matches)},r.is=i,r.getState=function(t){return t?i(t):Object.keys(s).filter(i)},r}),i("nbd/util/pipe",[],function(){return function(){var t=arguments;return function(){var n,e;for(n=0;t.length>n;++n)e=t[n].apply(this,0===n?arguments:[e]);return e}}}),i("nbd/util/protochain",[],function(){function t(n,e){var i,r;(r=Object.getPrototypeOf(n))!==Object.prototype&&(t(r,e),e=r.constructor.prototype),i=Object.create(e);for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);i.constructor=n.constructor,n.constructor.prototype=i}return function(n,e,i){if(2>arguments.length)throw new TypeError("Not enough arguments");if("function"!=typeof n)throw new TypeError("First argument must be a constructor");if("function"!=typeof e)throw new TypeError("Second argument must be a constructor");for(var r,o=n.prototype;(r=Object.getPrototypeOf(o))!==Object.prototype;)o=r;try{if(o.__proto__)return o.__proto__=e.prototype,void 0}catch(s){if(i!==!0)throw s}if(i!==!0)throw Error("Cannot modify prototype chain");t(n.prototype,e.prototype)}}),i("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/pubsub","nbd/trait/jquery.tmpl","nbd/util/async","nbd/util/construct","nbd/util/deparam","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(n,e,i,r,o,s,u,c,f,a,l,p,h,d,y,b,w,v){var g={Class:n,Model:e,View:i,Controller:s,event:c,trait:{pubsub:f,"jquery.tmpl":a},util:{async:l,construct:p,deparam:h,diff:d,extend:y,media:b,pipe:w,protochain:v}};return g.View.Element=o,g.View.Entity=r,g.Controller.Entity=u,t.nbd=g,g})})(this);