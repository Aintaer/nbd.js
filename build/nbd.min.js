!function(t){var e,n,i;!function(t){function r(t,e){return m.call(t,e)}function o(t,e){var n,i,r,o,s,u,c,f,a,l,p=e&&e.split("/"),h=w.map,d=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),f=0;f<t.length;f+=1)if(l=t[f],"."===l)t.splice(f,1),f-=1;else if(".."===l){if(1===f&&(".."===t[2]||".."===t[0]))break;f>0&&(t.splice(f-1,2),f-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||d)&&h){for(n=t.split("/"),f=n.length;f>0;f-=1){if(i=n.slice(0,f).join("/"),p)for(a=p.length;a>0;a-=1)if(r=h[p.slice(0,a).join("/")],r&&(r=r[i])){o=r,s=f;break}if(o)break;!u&&d&&d[i]&&(u=d[i],c=f)}!o&&u&&(o=u,s=c),o&&(n.splice(0,s,o),t=n.join("/"))}return t}function s(e,n){return function(){return h.apply(t,_.call(arguments,0).concat([e,n]))}}function u(t){return function(e){return o(e,t)}}function c(t){return function(e){v[t]=e}}function f(e){if(r(b,e)){var n=b[e];delete b[e],g[e]=!0,p.apply(t,n)}if(!r(v,e)&&!r(g,e))throw new Error("No "+e);return v[e]}function a(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function l(t){return function(){return w&&w.config&&w.config[t]||{}}}var p,h,d,y,v={},b={},w={},g={},m=Object.prototype.hasOwnProperty,_=[].slice;d=function(t,e){var n,i=a(t),r=i[0];return t=i[1],r&&(r=o(r,e),n=f(r)),r?t=n&&n.normalize?n.normalize(t,u(e)):o(t,e):(t=o(t,e),i=a(t),r=i[0],t=i[1],r&&(n=f(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:n}},y={require:function(t){return s(t)},exports:function(t){var e=v[t];return"undefined"!=typeof e?e:v[t]={}},module:function(t){return{id:t,uri:"",exports:v[t],config:l(t)}}},p=function(e,n,i,o){var u,a,l,p,h,w,m=[];if(o=o||e,"function"==typeof i){for(n=!n.length&&i.length?["require","exports","module"]:n,h=0;h<n.length;h+=1)if(p=d(n[h],o),a=p.f,"require"===a)m[h]=y.require(e);else if("exports"===a)m[h]=y.exports(e),w=!0;else if("module"===a)u=m[h]=y.module(e);else if(r(v,a)||r(b,a)||r(g,a))m[h]=f(a);else{if(!p.p)throw new Error(e+" missing "+a);p.p.load(p.n,s(o,!0),c(a),{}),m[h]=v[a]}l=i.apply(v[e],m),e&&(u&&u.exports!==t&&u.exports!==v[e]?v[e]=u.exports:l===t&&w||(v[e]=l))}else e&&(v[e]=i)},e=n=h=function(e,n,i,r,o){return"string"==typeof e?y[e]?y[e](n):f(d(e,n).f):(e.splice||(w=e,n.splice?(e=n,n=i,i=null):e=t),n=n||function(){},"function"==typeof i&&(i=r,r=o),r?p(t,e,n,i):setTimeout(function(){p(t,e,n,i)},4),h)},h.config=function(t){return w=t,w.deps&&h(w.deps,w.callback),h},i=function(t,e,n){e.splice||(n=e,e=[]),r(v,t)||r(b,t)||(b[t]=[t,e,n])},i.amd={jQuery:!0}}(),i("node_modules/almond/almond",function(){}),i("nbd/Class",[],function(){function t(t,e){return function(){return t.apply(this,arguments),e.apply(this,arguments)}}var e,n,i,r,o=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return n=function(e,s){function u(t,e,n){var i=function(){return p[t].apply(this,arguments)};return function(){var t=this.hasOwnProperty("_super"),r=this._super;this._super=i;try{return n&&this._super.apply(this,arguments),e.apply(this,arguments)}catch(o){throw o}finally{t&&(this._super=r)}}}function c(){"function"==typeof this.init&&this.init.apply(this,arguments)}var f,a,l,p=this.prototype;f=Object.create(p);for(a in e)e.hasOwnProperty(a)&&(l="init"===a&&!(s&&s.hasOwnProperty("_")&&s._),f[a]="function"==typeof e[a]&&"function"==typeof p[a]&&(l||o.test(e[a]))?u(a,e[a],l):e[a]);for(a in this)this.hasOwnProperty(a)&&(c[a]=this[a]);for(a in s)s.hasOwnProperty(a)&&(l="init"===a&&!(s&&s.hasOwnProperty("_")&&s._),c[a]=l&&"function"==typeof c[a]&&"function"==typeof s[a]?t(c[a],s[a]):s[a]);return c.prototype=f,Object.defineProperty(c.prototype,"constructor",{value:c}),Object.defineProperties(c,{extend:{value:n,enumerable:!1},mixin:{value:i},inherits:{value:r}}),c},i=function(t){var e={};return Object.keys(t).forEach(function(n){e[n]={configurable:!1,value:t[n]}}),Object.defineProperties(this.prototype,e),this},r=function(t){var e,n=!1;if("function"==typeof t)return t.prototype.isPrototypeOf(this.prototype);if("object"==typeof t){n=!0;for(e in t)if(t.hasOwnProperty(e)&&t[e]!==this.prototype[e]){n=!1;break}}return n},e=function(){},e.extend=n,e}),i("nbd/util/async",[],function(){function t(t){i.push(t),postMessage(r,"*")}function e(t){if(t.source===window&&t.data===r&&(t.stopPropagation(),i.length>0)){var e=i.shift();e()}}var n,i=[],r="async-message",o="function"==typeof postMessage&&"function"==typeof addEventListener;return o&&addEventListener("message",e,!0),n=o?t:function(t){setTimeout(t,0)}}),i("nbd/util/extend",[],function(){return function(t){var e,n,i;for(e=1;e<arguments.length;++e){i=arguments[e];for(n in i)t[n]=i[n]}return t}}),i("nbd/util/diff",["./extend"],function(t){function e(t,i){var r,o=!0;if(Object.getPrototypeOf(t)!==Object.prototype||Object.getPrototypeOf(i)!==Object.prototype)return!1;for(r in t){if(t[r]!==i[r])return!1;if(t.hasOwnProperty(r)&&"object"==typeof t[r]&&t[r]&&Object.getPrototypeOf(t[r])===Object.prototype){if(~n.indexOf(t[r]))continue;try{n.push(t[r]),o=o&&e(i[r],t[r])}catch(s){}finally{n.pop()}}if(!o)return o}return o}var n=[];return function(n,i,r){var o,s,u,c={};if("object"!=typeof i||"object"!=typeof n||null===i||null===n)throw new TypeError("Arguments must be objects");i=t({},i);for(o in n)if(n.hasOwnProperty(o)){if(s=n[o],u=i[o],delete i[o],s===u)continue;"object"==typeof s&&"object"==typeof u&&s&&u&&e(s,u)||(c[o]=[s,u],r&&r.apply(this,[o,s,u]))}for(o in i)i.hasOwnProperty(o)&&void 0!==i[o]&&(c[o]=[n[o]],r&&r.apply(this,[o,void 0,i[o]]));return c}}),i("nbd/trait/pubsub",[],function(){var t=/\s+/,e=function n(t){return n.i=n.i||0,(t||"")+ ++n.i};return{on:function(e,n,i){var r,o,s;if(!n)return this;for(e=e.split(t),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),r=this._callbacks;o=e.shift();)s=r[o]||(r[o]=[]),s.push(n,i);return this},off:function(e,n,i){var r,o,s,u;if(!(o=this._callbacks))return this;if(!(e||n||i))return delete this._callbacks,this;for(e=e?e.split(t):Object.keys(o);r=e.shift();)if((s=o[r])&&(n||i))for(u=s.length-2;u>=0;u-=2)n&&s[u]!==n||i&&s[u+1]!==i||s.splice(u,2);else delete o[r];return this},trigger:function(e){var n,i,r,o,s,u,c,f;if(!(i=this._callbacks))return this;for(f=[],e=e.split(t),o=1,s=arguments.length;s>o;o++)f[o-1]=arguments[o];for(;n=e.shift();){if((c=i.all)&&(c=c.slice()),(r=i[n])&&(r=r.slice()),r)for(o=0,s=r.length;s>o;o+=2)r[o].apply(r[o+1]||this,f);if(c)for(u=[n].concat(f),o=0,s=c.length;s>o;o+=2)c[o].apply(c[o+1]||this,u)}return this},listenTo:function(t,n,i){var r=this._listeners||(this._listeners={}),o=t._listenerId||(t._listenerId=e("l"));return r[o]=t,t.on(n,i||this,this),this},stopListening:function(t,e,n){var i=this._listeners;if(i){if(t)t.off(e,n,this),e||n||delete i[t._listenerId];else{for(var r in i)i[r].off(null,null,this);this._listeners={}}return this}}}}),i("nbd/Model",["./Class","./util/async","./util/extend","./util/diff","./trait/pubsub"],function(t,e,n,i,r){var o=function(t,e){this._dirty&&(i.call(this,e||this._data,t,this.trigger),this._dirty=0)},s=t.extend({init:function(t,e){"string"==typeof t&&t.match(/^\d+$/)&&(t=+t),void 0===e&&(e=t),this.id=function(){return t};try{Object.defineProperty(this,"_dirty",{value:0,writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:e||{},writable:!0})}catch(n){this._dirty=0,this._data=e}},destroy:function(){this.off()},data:function(){return this._dirty++||e(o.bind(this,n({},this._data))),this._data},get:function(t){return this._data[t]},set:function(t,e){var n,i=this.data();if("string"==typeof t)return i[t]=e,this;if("object"==typeof t){for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return this}},toJSON:function(){return this._data}}).mixin(r);return s}),i("nbd/View",["./Class","./trait/pubsub"],function(t,e){var n=t.extend({$view:null,render:function(t){var e=this.$view;return this.trigger("prerender"),this.$view=this.template(t||this.templateData()),e&&e.length&&e.replaceWith(this.$view),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null,this.off()}}).mixin(e);return n}),i("nbd/View/Entity",["../View"],function(t){var e=t.extend({init:function(t){"object"==typeof t&&(this._model=this.Model=t),this.id=t&&t.id||function(){return t}},destroy:function(t){this._model.off(null,null,this),t||(this._model=this.Model=null),this._super()},templateData:function(){return this._model&&this._model.data?this._model.data():this.id()},render:function(t){var e=this.$view,n=!(e&&t);return n&&(this.trigger("prerender"),this.$view=this.template(this.templateData())),t?(e&&e.remove(),this.$view&&this.$view.appendTo(t)):e&&e.replaceWith(this.$view),n&&(this.trigger("postrender",this.$view),"function"==typeof this.rendered&&this.rendered(this.$view)),this.$view}});return e}),i("nbd/View/Element",["../View"],function(t){var e=t.extend({$parent:null,init:function(t){this.$parent=t},render:function(t){var e=this.$view;return this.trigger("prerender"),this.$view=this.template(t||this.templateData()),e&&e.length?e.replaceWith(this.$view):this.$view.appendTo(this.$parent),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view}});return e}),i("nbd/util/construct",[],function(){var t=Object.prototype.toString;return function(){if(!(t.call(this).indexOf("Function")+1))throw new TypeError("construct called on incompatible Object");var e=Object.create(this.prototype),n=this.apply(e,arguments);return Object(n)===n?n:e}}),i("nbd/Controller",["./Class","./View","./util/construct"],function(t,e,n){var i=t.extend({View:null,destroy:function(){},_initView:function(t){var e=Array.prototype.slice.call(arguments,1);(this._view=this.View=n.apply(t,e)).Controller=this},switchView:function(){var t=this._view;this._initView.apply(this,arguments),t&&(t.$view&&(this._view.$view=t.$view,this._view.render()),t.destroy())}});return i}),i("nbd/Controller/Entity",["../util/construct","../Controller","../View/Entity","../Model"],function(t,e,n,i){var r=e.extend({Model:null,init:function(){this.Model=t.apply(this.constructor.MODEL_CLASS,arguments),this._initView(this.constructor.VIEW_CLASS,this.Model)},render:function(t,e){e=e||this.constructor.VIEW_CLASS,this.requestView(e),this.View.render(t)},destroy:function(){this.View.destroy(),this.Model.destroy(),this.Model=this.View=null},requestView:function(t){this.View instanceof t||this.switchView(t,this.Model)}},{VIEW_CLASS:n,MODEL_CLASS:i});return r}),i("nbd/event",["./util/extend","./trait/pubsub"],function(t,e){var n=t({},e);return n.bind=n.on,n.unbind=n.off,n.fire=n.trigger,n}),i("nbd/trait/promise",["../util/async","../util/extend"],function(t,e){function n(){function e(e){e.length&&t(function(){for(var t=0;t<e.length;++t)e[t](u)}),f=a=[]}function i(t){l||(l=1,u=t,e(f))}function r(t){l||(l=-1,u=t,e(a))}function o(t){if(t===c)throw new TypeError("Cannot resolve with self");if(t instanceof n)return t.then(o,r),void 0;try{if(("object"==typeof t||"function"==typeof t)&&null!==t&&"function"==typeof t.then)return function(){var e=!1;try{t.then(function(n){e||(t===n?i(t):o(n),e=!0)},function(t){e||(r(t),e=!0)})}catch(n){e||r(n)}}()}catch(e){return r(e),void 0}i(t)}function s(e,i){function r(t){return function(e){var n;try{n=t(e)}catch(i){o.reject(i)}o.resolve(n)}}var o=new n;if(l){var s=l>0?e:i;"function"==typeof s?(s=r(s),t(function(){s(u)})):o[l>0?"resolve":"reject"](u)}else f.push("function"==typeof e?r(e):o.resolve),a.push("function"==typeof i?r(i):o.reject);return o}var u,c=this,f=[],a=[],l=0;Object.defineProperties(this,{reject:{value:r},resolve:{value:o}}),this.then=s}n.prototype.thenable=function(){return{then:this.then}},n.prototype.promise=function(){var t=this.then,e=function(){return n},n={done:function(){var e=Array.prototype.concat.apply([],arguments);return e.forEach(function(e){t(e)}),n},fail:function(){var e=Array.prototype.concat.apply([],arguments);return e.forEach(function(e){t(void 0,e)}),n},then:t,progress:e,promise:e};return n};var i=function(){this._promise||Object.defineProperty(this,"_promise",{value:new n})};return e(n,{then:function(t,e){return i.call(this),this._promise.then(t,e)},resolve:function(t){return i.call(this),this._promise.resolve(t),this},reject:function(t){return i.call(this),this._promise.reject(t),this},thenable:function(){return i.call(this),this._promise.thenable()},promise:function(){return i.call(this),this._promise.promise()}}),n}),i("nbd/util/deparam",[],function(){return function(t,e){var n={},i={"true":!0,"false":!1,"null":null};return t.replace(/\+/g," ").split("&").forEach(function(t){var r,o=t.split("="),s=decodeURIComponent(o[0]),u=n,c=0,f=s.split("]["),a=f.length-1;if(/\[/.test(f[0])&&/\]$/.test(f[a])?(f[a]=f[a].replace(/\]$/,""),f=f.shift().split("[").concat(f),a=f.length-1):a=0,2===o.length)if(r=decodeURIComponent(o[1]),e&&(r=r&&!isNaN(r)?+r:"undefined"===r?void 0:void 0!==i[r]?i[r]:r),a)for(c;a>=c;c++)s=""===f[c]?u.length:f[c],u=u[s]=a>c?u[s]||(f[c+1]&&isNaN(f[c+1])?{}:[]):r;else Array.isArray(n[s])?n[s].push(r):n[s]=void 0!==n[s]?[n[s],r]:r;else s&&(n[s]=e?void 0:"")}),n}}),i("nbd/util/media",["./extend","../trait/pubsub"],function(t,e){function n(t,e){var n=u(e);s[t]=n,n.addListener(o.bind(n,t)),n.matches&&o.call(n,t)}function i(t){return s[t]&&s[t].matches}function r(t,e){var i;if(!u)throw new Error("Media queries not supported.");if("string"==typeof t)return n(t,e),r;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(e=t[i],n(i,e));return r}var o,s={},u="undefined"!=typeof matchMedia?matchMedia:"undefined"!=typeof msMatchMedia?msMatchMedia:null;return t(r,e),o=function(t){r.trigger(t+(this.matches?":enter":":exit")),r.trigger(t,this.matches)},r.is=i,r.getState=function(t){return t?i(t):Object.keys(s).filter(i)},r}),i("nbd/util/pipe",[],function(){return function(){var t=arguments;return function(){var e,n;for(e=0;e<t.length;++e)n=t[e].apply(this,0===e?arguments:[n]);return n}}}),i("nbd/util/protochain",[],function(){function t(e,n){var i,r;(r=Object.getPrototypeOf(e))!==Object.prototype&&(t(r,n),n=r.constructor.prototype),i=Object.create(n);for(r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);i.constructor=e.constructor,e.constructor.prototype=i}return function(e,n,i){if(arguments.length<2)throw new TypeError("Not enough arguments");if("function"!=typeof e)throw new TypeError("First argument must be a constructor");if("function"!=typeof n)throw new TypeError("Second argument must be a constructor");for(var r,o=e.prototype;(r=Object.getPrototypeOf(o))!==Object.prototype;)o=r;if(i!==!0){if(o.__proto__)return o.__proto__=n.prototype,void 0;throw new Error("Cannot modify prototype chain")}t(e.prototype,n.prototype)}}),i("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/promise","nbd/trait/pubsub","nbd/util/async","nbd/util/construct","nbd/util/deparam","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(t,e,n,i,r,o,s,u,c,f,a,l,p,h,d,y,v,b){var w={Class:t,Model:e,View:n,Controller:o,event:u,trait:{promise:c,pubsub:f},util:{async:a,construct:l,deparam:p,diff:h,extend:d,media:y,pipe:v,protochain:b}};return w.View.Element=r,w.View.Entity=i,w.Controller.Entity=s,w}),t.nbd=n("build/all")}(this);