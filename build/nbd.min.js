(function(global){var requirejs,require,define;(function(undef){var main,req,makeMap,handlers,defined={},waiting={},config={},defining={},hasOwn=Object.prototype.hasOwnProperty,aps=[].slice;function hasProp(obj,prop){return hasOwn.call(obj,prop)}function normalize(name,baseName){var nameParts,nameSegment,mapValue,foundMap,foundI,foundStarMap,starI,i,j,part,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"]||{};if(name&&name.charAt(0)==="."){if(baseName){baseParts=baseParts.slice(0,baseParts.length-1);name=baseParts.concat(name.split("/"));for(i=0;i<name.length;i+=1){part=name[i];if(part==="."){name.splice(i,1);i-=1}else if(part===".."){if(i===1&&(name[2]===".."||name[0]==="..")){break}else if(i>0){name.splice(i-1,2);i-=2}}}name=name.join("/")}else if(name.indexOf("./")===0){name=name.substring(2)}}if((baseParts||starMap)&&map){nameParts=name.split("/");for(i=nameParts.length;i>0;i-=1){nameSegment=nameParts.slice(0,i).join("/");if(baseParts){for(j=baseParts.length;j>0;j-=1){mapValue=map[baseParts.slice(0,j).join("/")];if(mapValue){mapValue=mapValue[nameSegment];if(mapValue){foundMap=mapValue;foundI=i;break}}}}if(foundMap){break}if(!foundStarMap&&starMap&&starMap[nameSegment]){foundStarMap=starMap[nameSegment];starI=i}}if(!foundMap&&foundStarMap){foundMap=foundStarMap;foundI=starI}if(foundMap){nameParts.splice(0,foundI,foundMap);name=nameParts.join("/")}}return name}function makeRequire(relName,forceSync){return function(){return req.apply(undef,aps.call(arguments,0).concat([relName,forceSync]))}}function makeNormalize(relName){return function(name){return normalize(name,relName)}}function makeLoad(depName){return function(value){defined[depName]=value}}function callDep(name){if(hasProp(waiting,name)){var args=waiting[name];delete waiting[name];defining[name]=true;main.apply(undef,args)}if(!hasProp(defined,name)&&!hasProp(defining,name)){throw new Error("No "+name)}return defined[name]}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;if(index>-1){prefix=name.substring(0,index);name=name.substring(index+1,name.length)}return[prefix,name]}makeMap=function(name,relName){var plugin,parts=splitPrefix(name),prefix=parts[0];name=parts[1];if(prefix){prefix=normalize(prefix,relName);plugin=callDep(prefix)}if(prefix){if(plugin&&plugin.normalize){name=plugin.normalize(name,makeNormalize(relName))}else{name=normalize(name,relName)}}else{name=normalize(name,relName);parts=splitPrefix(name);prefix=parts[0];name=parts[1];if(prefix){plugin=callDep(prefix)}}return{f:prefix?prefix+"!"+name:name,n:name,pr:prefix,p:plugin}};function makeConfig(name){return function(){return config&&config.config&&config.config[name]||{}}}handlers={require:function(name){return makeRequire(name)},exports:function(name){var e=defined[name];if(typeof e!=="undefined"){return e}else{return defined[name]={}}},module:function(name){return{id:name,uri:"",exports:defined[name],config:makeConfig(name)}}};main=function(name,deps,callback,relName){var cjsModule,depName,ret,map,i,args=[],usingExports;relName=relName||name;if(typeof callback==="function"){deps=!deps.length&&callback.length?["require","exports","module"]:deps;for(i=0;i<deps.length;i+=1){map=makeMap(deps[i],relName);depName=map.f;if(depName==="require"){args[i]=handlers.require(name)}else if(depName==="exports"){args[i]=handlers.exports(name);usingExports=true}else if(depName==="module"){cjsModule=args[i]=handlers.module(name)}else if(hasProp(defined,depName)||hasProp(waiting,depName)||hasProp(defining,depName)){args[i]=callDep(depName)}else if(map.p){map.p.load(map.n,makeRequire(relName,true),makeLoad(depName),{});args[i]=defined[depName]}else{throw new Error(name+" missing "+depName)}}ret=callback.apply(defined[name],args);if(name){if(cjsModule&&cjsModule.exports!==undef&&cjsModule.exports!==defined[name]){defined[name]=cjsModule.exports}else if(ret!==undef||!usingExports){defined[name]=ret}}}else if(name){defined[name]=callback}};requirejs=require=req=function(deps,callback,relName,forceSync,alt){if(typeof deps==="string"){if(handlers[deps]){return handlers[deps](callback)}return callDep(makeMap(deps,callback).f)}else if(!deps.splice){config=deps;if(callback.splice){deps=callback;callback=relName;relName=null}else{deps=undef}}callback=callback||function(){};if(typeof relName==="function"){relName=forceSync;forceSync=alt}if(forceSync){main(undef,deps,callback,relName)}else{setTimeout(function(){main(undef,deps,callback,relName)},15)}return req};req.config=function(cfg){config=cfg;return req};define=function(name,deps,callback){if(!deps.splice){callback=deps;deps=[]}if(!hasProp(defined,name)&&!hasProp(waiting,name)){waiting[name]=[name,deps,callback]}};define.amd={jQuery:true}})();define("vendor/almond/almond",function(){});define("nbd/Class",[],function(){var Klass,inherits,mixin,initializing=false,fnTest=/xyz;/.test(function(){var xyz;return xyz})?/\b_super\b/:/.*/;mixin=function(abstract){var prop,descriptor={};for(prop in abstract){if(abstract.hasOwnProperty(prop)){descriptor[prop]={value:abstract[prop]}}}Object.defineProperties(this.prototype,descriptor);return this};inherits=function(superclass){var prop,result=false;if(typeof superclass==="function"){return superclass.prototype.isPrototypeOf(this.prototype)}if(typeof superclass==="object"){result=true;for(prop in superclass){if(superclass.hasOwnProperty(prop)&&superclass[prop]!==this.prototype[prop]){result=false;break}}}return result};Klass=function(){};Klass.inherits=inherits;Klass.extend=function extend(prop,stat){var prototype,name,initfn,_super=this.prototype;initializing=true;prototype=new this;initializing=false;function protochain(name,fn,initfn){return function(){var hadSuper=this.hasOwnProperty("_super"),tmp=this._super;this._super=_super[name];if(initfn){this._super.apply(this,arguments)}try{return fn.apply(this,arguments)}catch(e){}finally{if(hadSuper){this._super=tmp}}}}function chainFn(parent,child){return function(){parent.apply(this,arguments);return child.apply(this,arguments)}}for(name in prop){if(prop.hasOwnProperty(name)){initfn=name==="init"&&!(stat&&stat.hasOwnProperty("_")&&stat._);prototype[name]=typeof prop[name]==="function"&&typeof _super[name]==="function"&&(initfn||fnTest.test(prop[name]))?protochain(name,prop[name],initfn):prop[name]}}function Class(){if(!initializing&&typeof this.init==="function"){this.init.apply(this,arguments)}}for(name in this){if(this.hasOwnProperty(name)){Class[name]=this[name]}}for(name in stat){if(stat.hasOwnProperty(name)){initfn=name==="init"&&!(stat&&stat.hasOwnProperty("_")&&stat._);Class[name]=initfn&&typeof Class[name]==="function"&&typeof stat[name]==="function"?chainFn(Class[name],stat[name]):stat[name]}}Class.prototype=prototype;Class.prototype.constructor=Class;Class.extend=extend;Class.mixin=mixin;Class.__super__=_super;return Class};return Klass});define("nbd/util/async",[],function(){var timeouts=[],messageName="async-message",hasPostMessage=typeof window.postMessage==="function"&&typeof window.addEventListener==="function",async;function setZeroTimeout(fn){timeouts.push(fn);window.postMessage(messageName,"*")}function handleMessage(event){if(event.source===window&&event.data===messageName){event.stopPropagation();if(timeouts.length>0){var fn=timeouts.shift();fn()}}}if(hasPostMessage){window.addEventListener("message",handleMessage,true)}async=hasPostMessage?setZeroTimeout:function(fn){window.setTimeout(fn,0)};return async});define("nbd/util/extend",[],function(){return function(obj){var i,prop,source;for(i=1;i<arguments.length;++i){source=arguments[i];for(prop in source){obj[prop]=source[prop]}}return obj}});define("nbd/util/diff",["nbd/util/extend"],function(extend){var stack=[];function objectCheck(cur,prev){var key,equal=true;for(key in cur){if(cur[key]!==prev[key]){return false}if(cur[key]&&cur.hasOwnProperty(key)&&typeof cur[key]==="object"){if(stack.indexOf(cur[key])>=0){continue}try{stack.push(cur[key]);equal=equal&&objectCheck(prev[key],cur[key])}catch(emptyArgs){}finally{stack.pop()}}if(!equal){return equal}}return equal}return function diff(cur,prev,callback){var key,difference,differences={};if(typeof prev!=="object"||typeof cur!=="object"||prev===null||cur===null){throw new TypeError("Arguments must be ojects")}prev=extend({},prev);for(key in cur){if(cur.hasOwnProperty(key)){if(prev[key]!==cur[key]||typeof cur[key]==="object"&&cur[key]&&!objectCheck(cur[key],prev[key])){differences[key]=[cur[key],prev[key]];if(callback){callback.apply(this,[key,cur[key],prev[key]])}}delete prev[key]}}for(key in prev){if(prev.hasOwnProperty(key)){differences[key]=[cur[key]];if(callback){callback.apply(this,[key,undefined,prev[key]])}}}return differences}});define("nbd/trait/pubsub",[],function(){var eventSplitter=/\s+/;return{on:function(events,callback,context){var calls,event,list;if(!callback){return this}events=events.split(eventSplitter);if(!this._callbacks){Object.defineProperty(this,"_callbacks",{configurable:true,value:{},writable:true})}calls=this._callbacks;while(event=events.shift()){list=calls[event]||(calls[event]=[]);list.push(callback,context)}return this},off:function(events,callback,context){var event,calls,list,i;if(!(calls=this._callbacks)){return this}if(!(events||callback||context)){delete this._callbacks;return this}events=events?events.split(eventSplitter):Object.keys(calls);while(event=events.shift()){if(!(list=calls[event])||!(callback||context)){delete calls[event];continue}for(i=list.length-2;i>=0;i-=2){if(!(callback&&list[i]!==callback||context&&list[i+1]!==context)){list.splice(i,2)}}}return this},trigger:function(events){var event,calls,list,i,length,args,all,rest;if(!(calls=this._callbacks)){return this}rest=[];events=events.split(eventSplitter);for(i=1,length=arguments.length;i<length;i++){rest[i-1]=arguments[i]}while(event=events.shift()){if(all=calls.all)all=all.slice();if(list=calls[event])list=list.slice();if(list){for(i=0,length=list.length;i<length;i+=2){list[i].apply(list[i+1]||this,rest)}}if(all){args=[event].concat(rest);for(i=0,length=all.length;i<length;i+=2){all[i].apply(all[i+1]||this,args)}}}return this}}});define("nbd/Model",["nbd/Class","nbd/util/async","nbd/util/extend","nbd/util/diff","nbd/trait/pubsub"],function(Class,async,extend,diff,pubsub){var dirtyCheck=function(old,novel){if(!this._dirty){return}diff.call(this,novel,old,this.trigger);this._dirty=false},constructor=Class.extend({init:function(id,data){if(typeof id==="string"&&id.match(/^\d+$/)){id=+id}if(data===undefined){data=id}this.id=function(){return id};Object.defineProperty(this,"_dirty",{writable:true});Object.defineProperty(this,"_data",{enumerable:false,configurable:true,value:data||{},writable:true})},destroy:function(){this.off(null)},data:function(){this._dirty=true;async(dirtyCheck.bind(this,extend({},this._data),this._data));return this._data},get:function(prop){return this._data[prop]},set:function(values,value){var key,data=this.data();if(typeof values==="string"){data[values]=value;return this}if(typeof values==="object"){for(key in values){if(values.hasOwnProperty(key)){data[key]=values[key]}}return this}},toJSON:function(){return this._data}}).mixin(pubsub);return constructor});define("nbd/View",["nbd/Class"],function(Class){var constructor=Class.extend({$view:null,render:function(data){var $existing=this.$view;this.$view=this.template(data||this.templateData());if($existing&&$existing.length){$existing.replaceWith(this.$view)}if(this.rendered){this.rendered(this.$view)}return this.$view},template:function(){},templateData:function(){return{}},destroy:function(){if(this.$view&&this.$view.remove){this.$view.remove()}this.$view=null}});return constructor});define("jquery",[],function(){return global.jQuery});define("nbd/Controller",["jquery","nbd/Class","nbd/View"],function($,Class,View){var constructor=Class.extend({init:function(){},destroy:function(){}},{addTemplate:function(id,html){return $('<script id="'+id+'" type="text/x-jquery-tmpl">'+html+"</script>").appendTo(document.body)},loadTemplate:function(view,callback){var wait=$.Deferred(),TEMPLATE_ID,TEMPLATE_URL;if(view.inherits&&view.inherits(View)){callback=typeof callback==="function"&&callback!==view?callback:null;TEMPLATE_ID=view.TEMPLATE_ID;TEMPLATE_URL=view.TEMPLATE_URL}if($("#"+TEMPLATE_ID).length){return $.Deferred().resolve()}if(!TEMPLATE_ID||!TEMPLATE_URL){$.error("No template found");return false}$.ajax({url:TEMPLATE_URL,cache:true}).then(function(data){var sargs=arguments;if(!data.html){return false}$(function(){constructor.addTemplate(TEMPLATE_ID,data.html);if($.isFunction(callback)){callback(TEMPLATE_ID)}wait.resolve.apply(wait,sargs)})},wait.reject,wait.notify);return wait.promise()}});return constructor});define("nbd/Events",["jquery"],function($){var cache={};function bind(ev,callback,options){if(typeof ev!=="string"){$.error("Invalid event name")}if(!$.isFunction(callback)){$.error("Invalid callback")}if(options&&cache[ev]){$.error("Provided options after initial bind")}if(!cache[ev]){options=options||"stopOnFalse";cache[ev]={cb:$.Callbacks(options),funcs:[]}}cache[ev].cb.add(callback);cache[ev].funcs.push(callback)}function option(ev,options){var inc,len,func;if(!cache[ev]){cache[ev]={cb:$.Callbacks(options),funcs:[]};return}cache[ev].cb.empty();cache[ev].cb=$.Callbacks(options);for(inc=0,len=cache[ev].funcs.length;inc<len;++inc){func=cache[ev].funcs[inc];cache[ev].cb.add(func)}}function updateOptions(ev,options){if(!cache[ev]){$.error("Event does not exist")}return option(ev,options)}function unbind(ev,callback){if(!cache[ev]){return}if(!callback){cache[ev].cb.empty();delete cache[ev];return}cache[ev].cb.remove(callback);cache[ev].funcs=$.grep(cache[ev].funcs,function(value){return value!==callback})}function trigger(ev){if(!cache[ev]){return}var pass=Array.prototype.slice.call(arguments,1);cache[ev].cb.fireWith(null,pass)}return{bind:bind,unbind:unbind,trigger:trigger,option:option,updateOptions:updateOptions}});define("nbd/trait/jquery.tmpl",["jquery"],function($){return{template:function(){var script=this.templateScript();return script.tmpl.apply(script,arguments)},templateScript:function(strict){strict=typeof strict!=="undefined"?strict:true;if(!this.constructor.$TEMPLATE||!this.constructor.$TEMPLATE.length){this.constructor.$TEMPLATE=$("#"+this.constructor.TEMPLATE_ID)}if(!this.constructor.$TEMPLATE.length){if(strict===true){$.error("Missing template: "+this.constructor.TEMPLATE_ID)}else{return false}}return this.constructor.$TEMPLATE}}});define("nbd/util/media",["nbd/util/extend","nbd/trait/pubsub"],function(extend,pubsub){var mqChange,mediaCheck,matchMedia=window.matchMedia||window.msMatchMedia;function bindMedia(breakpoint,query){var match=window.matchMedia(query);match.addListener(mqChange.bind(match,breakpoint));if(match.matches){mqChange.call(match,breakpoint)}}mediaCheck=function media(options,query){var breakpoint;if(!matchMedia){throw new Error("Media queries not supported.")}if(typeof options==="string"){bindMedia(options,query);return media}if(typeof options==="object"){for(breakpoint in options){if(options.hasOwnProperty(breakpoint)){query=options[breakpoint];bindMedia(breakpoint,query)}}}return media};extend(mediaCheck,pubsub);mqChange=function(breakpoint){mediaCheck.trigger(breakpoint+this.matches?":enter":":exit");mediaCheck.trigger(breakpoint)};return mediaCheck});define("nbd/util/pipe",[],function(){return function chain(){var chainArgs=arguments;return function(){var i,retval;for(i=0;i<chainArgs.length;++i){retval=chainArgs[i].apply(this,i===0?arguments:[retval])}return retval}}});define("nbd/util/protochain",[],function(){function swapProto(lProto,oProto){var inst,p;if((p=Object.getPrototypeOf(lProto))!==Object.prototype){swapProto(p,oProto);oProto=p.constructor.prototype}inst=Object.create(oProto);for(p in lProto){if(lProto.hasOwnProperty(p)){inst[p]=lProto[p]}}inst.constructor=lProto.constructor;lProto.constructor.prototype=inst}return function(Klass,Class,forced){if(arguments.length<2){throw new TypeError("Not enough arguments")}if(typeof Klass!=="function"){throw new TypeError("First argument must be a constructor")}if(typeof Class!=="function"){throw new TypeError("Second argument must be a constructor")}var it=Klass.prototype,up;while((up=Object.getPrototypeOf(it))!==Object.prototype){it=up}try{if(it.__proto__){it.__proto__=Class.prototype;return}}catch(noProto){if(forced!==true){throw noProto}}if(forced!==true){throw new Error("Cannot modify prototype chain")}swapProto(Klass.prototype,Class.prototype)}});require(["nbd/Class","nbd/Model","nbd/View","nbd/Controller","nbd/Events","nbd/trait/pubsub","nbd/trait/jquery.tmpl","nbd/util/async","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(Class,Model,View,Controller,events,pubsub,jqtmpl,async,diff,extend,media,pipe,protochain){var exports={Class:Class,Model:Model,View:View,Controller:Controller,Events:events,trait:{pubsub:pubsub,"jquery.tmpl":jqtmpl},util:{async:async,diff:diff,extend:extend,media:media,pipe:pipe,protochain:protochain}};global.nbd=exports});define("build/all",function(){})})(this);