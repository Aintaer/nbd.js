(function(t){var n,e,i;(function(t){function r(t,n){return g.call(t,n)}function o(t,n){var e,i,r,o,u,s,f,c,a,l,p=n&&n.split("/"),h=v.map,d=h&&h["*"]||{};if(t&&"."===t.charAt(0))if(n){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),c=0;t.length>c;c+=1)if(l=t[c],"."===l)t.splice(c,1),c-=1;else if(".."===l){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||d)&&h){for(e=t.split("/"),c=e.length;c>0;c-=1){if(i=e.slice(0,c).join("/"),p)for(a=p.length;a>0;a-=1)if(r=h[p.slice(0,a).join("/")],r&&(r=r[i])){o=r,u=c;break}if(o)break;!s&&d&&d[i]&&(s=d[i],f=c)}!o&&s&&(o=s,u=f),o&&(e.splice(0,u,o),t=e.join("/"))}return t}function u(n,e){return function(){return h.apply(t,_.call(arguments,0).concat([n,e]))}}function s(t){return function(n){return o(n,t)}}function f(t){return function(n){b[t]=n}}function c(n){if(r(w,n)){var e=w[n];delete w[n],m[n]=!0,p.apply(t,e)}if(!r(b,n)&&!r(m,n))throw Error("No "+n);return b[n]}function a(t){var n,e=t?t.indexOf("!"):-1;return e>-1&&(n=t.substring(0,e),t=t.substring(e+1,t.length)),[n,t]}function l(t){return function(){return v&&v.config&&v.config[t]||{}}}var p,h,d,y,b={},w={},v={},m={},g=Object.prototype.hasOwnProperty,_=[].slice;d=function(t,n){var e,i=a(t),r=i[0];return t=i[1],r&&(r=o(r,n),e=c(r)),r?t=e&&e.normalize?e.normalize(t,s(n)):o(t,n):(t=o(t,n),i=a(t),r=i[0],t=i[1],r&&(e=c(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:e}},y={require:function(t){return u(t)},exports:function(t){var n=b[t];return n!==void 0?n:b[t]={}},module:function(t){return{id:t,uri:"",exports:b[t],config:l(t)}}},p=function(n,e,i,o){var s,a,l,p,h,v,g=[];if(o=o||n,"function"==typeof i){for(e=!e.length&&i.length?["require","exports","module"]:e,h=0;e.length>h;h+=1)if(p=d(e[h],o),a=p.f,"require"===a)g[h]=y.require(n);else if("exports"===a)g[h]=y.exports(n),v=!0;else if("module"===a)s=g[h]=y.module(n);else if(r(b,a)||r(w,a)||r(m,a))g[h]=c(a);else{if(!p.p)throw Error(n+" missing "+a);p.p.load(p.n,u(o,!0),f(a),{}),g[h]=b[a]}l=i.apply(b[n],g),n&&(s&&s.exports!==t&&s.exports!==b[n]?b[n]=s.exports:l===t&&v||(b[n]=l))}else n&&(b[n]=i)},n=e=h=function(n,e,i,r,o){return"string"==typeof n?y[n]?y[n](e):c(d(n,e).f):(n.splice||(v=n,e.splice?(n=e,e=i,i=null):n=t),e=e||function(){},"function"==typeof i&&(i=r,r=o),r?p(t,n,e,i):setTimeout(function(){p(t,n,e,i)},15),h)},h.config=function(t){return v=t,h},i=function(t,n,e){n.splice||(e=n,n=[]),r(b,t)||r(w,t)||(w[t]=[t,n,e])},i.amd={jQuery:!0}})(),i("vendor/almond/almond",function(){}),i("nbd/Class",[],function(){var t,n,e,i=!1,r=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return e=function(t){var n,e={};for(n in t)t.hasOwnProperty(n)&&(e[n]={value:t[n]});return Object.defineProperties(this.prototype,e),this},n=function(t){var n,e=!1;if("function"==typeof t)return t.prototype.isPrototypeOf(this.prototype);if("object"==typeof t){e=!0;for(n in t)if(t.hasOwnProperty(n)&&t[n]!==this.prototype[n]){e=!1;break}}return e},t=function(){},t.inherits=n,t.extend=function o(t,n){function u(t,n,e){return function(){var i=this.hasOwnProperty("_super"),r=this._super;this._super=p[t],e&&this._super.apply(this,arguments);try{return n.apply(this,arguments)}catch(o){}finally{i&&(this._super=r)}}}function s(t,n){return function(){return t.apply(this,arguments),n.apply(this,arguments)}}function f(){i||"function"!=typeof this.init||this.init.apply(this,arguments)}var c,a,l,p=this.prototype;i=!0,c=new this,i=!1;for(a in t)t.hasOwnProperty(a)&&(l="init"===a&&!(n&&n.hasOwnProperty("_")&&n._),c[a]="function"==typeof t[a]&&"function"==typeof p[a]&&(l||r.test(t[a]))?u(a,t[a],l):t[a]);for(a in this)this.hasOwnProperty(a)&&(f[a]=this[a]);for(a in n)n.hasOwnProperty(a)&&(l="init"===a&&!(n&&n.hasOwnProperty("_")&&n._),f[a]=l&&"function"==typeof f[a]&&"function"==typeof n[a]?s(f[a],n[a]):n[a]);return f.prototype=c,f.prototype.constructor=f,f.extend=o,f.mixin=e,f.__super__=p,f},t}),i("nbd/util/async",[],function(){function t(t){i.push(t),window.postMessage(r,"*")}function n(t){if(t.source===window&&t.data===r&&(t.stopPropagation(),i.length>0)){var n=i.shift();n()}}var e,i=[],r="async-message",o="function"==typeof window.postMessage&&"function"==typeof window.addEventListener;return o&&window.addEventListener("message",n,!0),e=o?t:function(t){window.setTimeout(t,0)}}),i("nbd/util/extend",[],function(){return function(t){var n,e,i;for(n=1;arguments.length>n;++n){i=arguments[n];for(e in i)t[e]=i[e]}return t}}),i("nbd/util/diff",["nbd/util/extend"],function(t){function n(t,i){var r,o=!0;for(r in t){if(t[r]!==i[r])return!1;if(t[r]&&t.hasOwnProperty(r)&&"object"==typeof t[r]){if(e.indexOf(t[r])>=0)continue;try{e.push(t[r]),o=o&&n(i[r],t[r])}catch(u){}finally{e.pop()}}if(!o)return o}return o}var e=[];return function(e,i,r){var o,u={};if("object"!=typeof i||"object"!=typeof e||null===i||null===e)throw new TypeError("Arguments must be ojects");i=t({},i);for(o in e)e.hasOwnProperty(o)&&((i[o]!==e[o]||"object"==typeof e[o]&&e[o]&&!n(e[o],i[o]))&&(u[o]=[e[o],i[o]],r&&r.apply(this,[o,e[o],i[o]])),delete i[o]);for(o in i)i.hasOwnProperty(o)&&(u[o]=[e[o]],r&&r.apply(this,[o,,i[o]]));return u}}),i("nbd/trait/pubsub",[],function(){var t=/\s+/;return{on:function(n,e,i){var r,o,u;if(!e)return this;for(n=n.split(t),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),r=this._callbacks;o=n.shift();)u=r[o]||(r[o]=[]),u.push(e,i);return this},off:function(n,e,i){var r,o,u,s;if(!(o=this._callbacks))return this;if(!(n||e||i))return delete this._callbacks,this;for(n=n?n.split(t):Object.keys(o);r=n.shift();)if((u=o[r])&&(e||i))for(s=u.length-2;s>=0;s-=2)e&&u[s]!==e||i&&u[s+1]!==i||u.splice(s,2);else delete o[r];return this},trigger:function(n){var e,i,r,o,u,s,f,c;if(!(i=this._callbacks))return this;for(c=[],n=n.split(t),o=1,u=arguments.length;u>o;o++)c[o-1]=arguments[o];for(;e=n.shift();){if((f=i.all)&&(f=f.slice()),(r=i[e])&&(r=r.slice()),r)for(o=0,u=r.length;u>o;o+=2)r[o].apply(r[o+1]||this,c);if(f)for(s=[e].concat(c),o=0,u=f.length;u>o;o+=2)f[o].apply(f[o+1]||this,s)}return this}}}),i("nbd/Model",["nbd/Class","nbd/util/async","nbd/util/extend","nbd/util/diff","nbd/trait/pubsub"],function(t,n,e,i,r){var o=function(t,n){this._dirty&&(i.call(this,n,t,this.trigger),this._dirty=!1)},u=t.extend({init:function(t,n){"string"==typeof t&&t.match(/^\d+$/)&&(t=+t),void 0===n&&(n=t),this.id=function(){return t},Object.defineProperty(this,"_dirty",{writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:n||{},writable:!0})},destroy:function(){this.off(null)},data:function(){return this._dirty=!0,n(o.bind(this,e({},this._data),this._data)),this._data},get:function(t){return this._data[t]},set:function(t,n){var e,i=this.data();if("string"==typeof t)return i[t]=n,this;if("object"==typeof t){for(e in t)t.hasOwnProperty(e)&&(i[e]=t[e]);return this}},toJSON:function(){return this._data}}).mixin(r);return u}),i("nbd/View",["nbd/Class"],function(t){var n=t.extend({$view:null,render:function(t){var n=this.$view;return this.$view=this.template(t||this.templateData()),n&&n.length&&n.replaceWith(this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null}});return n}),i("jquery",[],function(){return t.jQuery}),i("nbd/View/Entity",["jquery","nbd/View","nbd/Model"],function(t,n,e){var i=n.extend({init:function(t){t instanceof e?(this.Model=t,this.id=this.Model.id):this.id=function(){return t}},templateData:function(){return this.Model?this.Model.data():this.id()},render:function(n){var e=this.$view,i=!!e^!!n;if(i)"string"!=typeof e&&(this.$view=this.template(this.templateData()));else if(!e)return;if("string"!=typeof e||(this.$view=t(this.$view),i=!!n))return n?n.append(this.$view):e.replaceWith(this.$view),i&&"function"==typeof this.rendered&&this.rendered(),this.$view}});return i}),i("nbd/View/Element",["jquery","nbd/View"],function(t,n){var e=n.extend({$parent:null,init:function(t){this.$parent=t},render:function(n){var e=this.$view&&this.$view.length;return e||(this.$view=t("<div/>").appendTo(this.$parent)),this._super(n),this.$view}});return e}),i("nbd/Controller",["jquery","nbd/Class","nbd/View"],function(t,n,e){var i=n.extend({init:function(){},destroy:function(){}},{addTemplate:function(n,e){return t('<script id="'+n+'" type="text/x-jquery-tmpl">'+e+"</script>").appendTo(document.body)},loadTemplate:function(n,r){var o,u,s=t.Deferred();return n.inherits&&n.inherits(e)&&(r="function"==typeof r&&r!==n?r:null,o=n.TEMPLATE_ID,u=n.TEMPLATE_URL),t("#"+o).length?t.Deferred().resolve():o&&u?(t.ajax({url:u,cache:!0}).then(function(n){var e=arguments;return n.html?(t(function(){i.addTemplate(o,n.html),t.isFunction(r)&&r(o),s.resolve.apply(s,e)}),void 0):!1},s.reject,s.notify),s.promise()):(t.error("No template found"),!1)}});return i}),i("nbd/Controller/Entity",["jquery","nbd/Controller"],function(t,n){var e=n.extend({View:null,Model:null,init:function(t,n){this.Model=new this.constructor.MODEL_CLASS(t,n),this._initView(this.Model)},render:function(t,n){n=n||this.constructor.VIEW_CLASS,this.requestView(n),this.View.render(t)},destroy:function(){this.View.destroy(),this.Model=this.View=null},_initView:function(t){this.View=new this.constructor.VIEW_CLASS(t),this.View.Controller=this},requestView:function(t){this.View instanceof t||!this.Model||this.switchView(t)},switchView:function(t){var n=this.View;this.View=new t(this.Model),this.View.Controller=this,n&&null!==n.$view&&(this.View.$view=n.$view,this.View.render()),n.destroy()}},{VIEW_CLASS:null,MODEL_CLASS:null});return e}),i("nbd/event",["nbd/util/extend","nbd/trait/pubsub"],function(t,n){var e=t({},n);return e.bind=e.on,e.unbind=e.off,e.fire=e.trigger,e}),i("nbd/trait/jquery.tmpl",["jquery"],function(t){return{template:function(){var t=this.templateScript();return t.tmpl.apply(t,arguments)},templateScript:function(n){if(n=n!==void 0?n:!0,this.constructor.$TEMPLATE&&this.constructor.$TEMPLATE.length||(this.constructor.$TEMPLATE=t("#"+this.constructor.TEMPLATE_ID)),!this.constructor.$TEMPLATE.length){if(n!==!0)return!1;t.error("Missing template: "+this.constructor.TEMPLATE_ID)}return this.constructor.$TEMPLATE}}}),i("nbd/util/media",["nbd/util/extend","nbd/trait/pubsub"],function(t,n){function e(t,n){var e=window.matchMedia(n);e.addListener(i.bind(e,t)),e.matches&&i.call(e,t)}var i,r,o=window.matchMedia||window.msMatchMedia;return r=function u(t,n){var i;if(!o)throw Error("Media queries not supported.");if("string"==typeof t)return e(t,n),u;if("object"==typeof t)for(i in t)t.hasOwnProperty(i)&&(n=t[i],e(i,n));return u},t(r,n),i=function(t){r.trigger(t+this.matches?":enter":":exit"),r.trigger(t)},r}),i("nbd/util/pipe",[],function(){return function(){var t=arguments;return function(){var n,e;for(n=0;t.length>n;++n)e=t[n].apply(this,0===n?arguments:[e]);return e}}}),i("nbd/util/protochain",[],function(){function t(n,e){var i,r;(r=Object.getPrototypeOf(n))!==Object.prototype&&(t(r,e),e=r.constructor.prototype),i=Object.create(e);for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);i.constructor=n.constructor,n.constructor.prototype=i}return function(n,e,i){if(2>arguments.length)throw new TypeError("Not enough arguments");if("function"!=typeof n)throw new TypeError("First argument must be a constructor");if("function"!=typeof e)throw new TypeError("Second argument must be a constructor");for(var r,o=n.prototype;(r=Object.getPrototypeOf(o))!==Object.prototype;)o=r;try{if(o.__proto__)return o.__proto__=e.prototype,void 0}catch(u){if(i!==!0)throw u}if(i!==!0)throw Error("Cannot modify prototype chain");t(n.prototype,e.prototype)}}),i("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/pubsub","nbd/trait/jquery.tmpl","nbd/util/async","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(n,e,i,r,o,u,s,f,c,a,l,p,h,d,y,b){var w={Class:n,Model:e,View:i,Controller:u,event:f,trait:{pubsub:c,"jquery.tmpl":a},util:{async:l,diff:p,extend:h,media:d,pipe:y,protochain:b}};return w.View.Element=o,w.View.Entity=r,w.Controller.Entity=s,t.nbd=w,w})})(this);