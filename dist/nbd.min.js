!function(a){var b,c,d;!function(a){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m=b&&b.split("/"),n=s.map,o=n&&n["*"]||{};if(a&&"."===a.charAt(0))if(b){for(m=m.slice(0,m.length-1),a=m.concat(a.split("/")),j=0;j<a.length;j+=1)if(l=a[j],"."===l)a.splice(j,1),j-=1;else if(".."===l){if(1===j&&(".."===a[2]||".."===a[0]))break;j>0&&(a.splice(j-1,2),j-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((m||o)&&n){for(c=a.split("/"),j=c.length;j>0;j-=1){if(d=c.slice(0,j).join("/"),m)for(k=m.length;k>0;k-=1)if(e=n[m.slice(0,k).join("/")],e&&(e=e[d])){f=e,g=j;break}if(f)break;!h&&o&&o[d]&&(h=o[d],i=j)}!f&&h&&(f=h,g=i),f&&(c.splice(0,g,f),a=c.join("/"))}return a}function g(b,c){return function(){return n.apply(a,v.call(arguments,0).concat([b,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(b){if(e(r,b)){var c=r[b];delete r[b],t[b]=!0,m.apply(a,c)}if(!e(q,b)&&!e(t,b))throw new Error("No "+b);return q[b]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return"undefined"!=typeof b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(b,c,d,f){var h,k,l,m,n,s,u=[];if(f=f||b,"function"==typeof d){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),k=m.f,"require"===k)u[n]=p.require(b);else if("exports"===k)u[n]=p.exports(b),s=!0;else if("module"===k)h=u[n]=p.module(b);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(b+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d.apply(q[b],u),b&&(h&&h.exports!==a&&h.exports!==q[b]?q[b]=h.exports:l===a&&s||(q[b]=l))}else b&&(q[b]=d)},b=c=n=function(b,c,d,e,f){return"string"==typeof b?p[b]?p[b](c):j(o(b,c).f):(b.splice||(s=b,c.splice?(b=c,c=d,d=null):b=a),c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(a,b,c,d):setTimeout(function(){m(a,b,c,d)},4),n)},n.config=function(a){return s=a,s.deps&&n(s.deps,s.callback),n},d=function(a,b,c){b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),d("node_modules/almond/almond",function(){}),d("nbd/Class",[],function(){"use strict";var a,b,c,d=function(){},e=/xyz/.test(function(){return xyz})?/\b_super\b/:/.*/;return b=function(a){var b={};return Object.keys(a).forEach(function(c){b[c]={configurable:!0,writable:!0,enumerable:!1,value:a[c]}}),Object.defineProperties(this.prototype,b),this},c=function(a){var b,c=!1;if("function"==typeof a)return a.prototype.isPrototypeOf(this.prototype);if("object"==typeof a){c=!0;for(b in a)if(a.hasOwnProperty(b)&&a[b]!==this.prototype[b]){c=!1;break}}return c},a=function(d,f){function g(a,b){var c=function(){return i[a].apply(this,arguments)};return function(){var a=this.hasOwnProperty("_super"),d=this._super;this._super=c;try{return b.apply(this,arguments)}catch(e){throw e}finally{a&&(this._super=d)}}}function h(){"function"==typeof this.init&&this.init.apply(this,arguments)}var i=this.prototype,j=function(a){h[a]=this[a]},k=Object.create(i);return d=d||{},f=f||{},Object.keys(d).forEach(function(a){var b=d[a];k[a]="function"==typeof b&&"function"==typeof i[a]&&e.test(b)?g(a,b):b}),Object.keys(this).forEach(j,this),Object.keys(f).forEach(j,f),h.prototype=k,Object.defineProperty(h.prototype,"constructor",{value:h}),Object.defineProperties(h,{extend:{value:a,enumerable:!1},mixin:{value:b},inherits:{value:c}}),h},d.extend=a,d}),d("nbd/util/async",[],function(){"use strict";function a(a){d.push(a),postMessage(e,"*")}function b(a){if(a.source===window&&a.data===e&&(a.stopPropagation(),d.length>0)){var b=d.shift();b()}}var c,d=[],e="async-message",f="function"==typeof postMessage&&"function"==typeof addEventListener;return f&&addEventListener("message",b,!0),c=f?a:function(a){setTimeout(a,0)}}),d("nbd/util/extend",[],function(){"use strict";return function(a){var b,c,d;for(b=1;b<arguments.length;++b){d=arguments[b];for(c in d)a[c]=d[c]}return a}}),d("nbd/util/diff",["./extend"],function(a){"use strict";function b(a,d){var e,f=!0;if(Object.getPrototypeOf(a)!==Object.prototype||Object.getPrototypeOf(d)!==Object.prototype)return!1;for(e in a){if(a[e]!==d[e])return!1;if(a.hasOwnProperty(e)&&"object"==typeof a[e]&&a[e]&&Object.getPrototypeOf(a[e])===Object.prototype){if(~c.indexOf(a[e]))continue;try{c.push(a[e]),f=f&&b(d[e],a[e])}catch(g){}finally{c.pop()}}if(!f)return f}return f}var c=[];return function(c,d,e){var f,g,h,i={};if("object"!=typeof d||"object"!=typeof c||null===d||null===c)throw new TypeError("Arguments must be objects");d=a({},d);for(f in c)if(c.hasOwnProperty(f)){if(g=c[f],h=d[f],delete d[f],g===h)continue;"object"==typeof g&&"object"==typeof h&&g&&h&&b(g,h)||(i[f]=[g,h],e&&e.apply(this,[f,g,h]))}for(f in d)d.hasOwnProperty(f)&&void 0!==d[f]&&(i[f]=[c[f]],e&&e.apply(this,[f,void 0,d[f]]));return i}}),d("nbd/trait/pubsub",[],function(){"use strict";var a=/\s+/,b=function c(a){return c.i=c.i||0,(a||"")+ ++c.i};return{on:function(b,c,d){var e,f,g;if(!c)return this;for(b=b.split(a),this._callbacks||Object.defineProperty(this,"_callbacks",{configurable:!0,value:{},writable:!0}),e=this._callbacks;f=b.shift();)g=e[f]||(e[f]=[]),g.push(c,d);return this},off:function(b,c,d){var e,f,g,h;if(!(f=this._callbacks))return this;if(!(b||c||d))return delete this._callbacks,this;for(b=b?b.split(a):Object.keys(f);e=b.shift();)if((g=f[e])&&(c||d))for(h=g.length-2;h>=0;h-=2)c&&g[h]!==c||d&&g[h+1]!==d||g.splice(h,2);else delete f[e];return this},trigger:function(b){var c,d,e,f,g,h,i,j;if(!(d=this._callbacks))return this;for(j=[],b=b.split(a),f=1,g=arguments.length;g>f;f++)j[f-1]=arguments[f];for(;c=b.shift();){if((i=d.all)&&(i=i.slice()),(e=d[c])&&(e=e.slice()),e)for(f=0,g=e.length;g>f;f+=2)e[f].apply(e[f+1]||this,j);if(i)for(h=[c].concat(j),f=0,g=i.length;g>f;f+=2)i[f].apply(i[f+1]||this,h)}return this},listenTo:function(a,c,d){var e=this._listeners||(this._listeners={}),f=a._listenerId||(a._listenerId=b("l"));return e[f]=a,a.on(c,d||this,this),this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,c,this),b||c||delete d[a._listenerId];else{for(var e in d)d[e].off(null,null,this);this._listeners={}}return this}}}}),d("nbd/Model",["./Class","./util/async","./util/extend","./util/diff","./trait/pubsub"],function(a,b,c,d,e){"use strict";var f=function(a,b){if(this._dirty){if(this._dirty!==!0)for(var c in this._dirty)this.trigger(c,this._data[c],this._dirty[c]);else{if(!a)return;d.call(this,b||this._data,a,this.trigger)}this._dirty=0}},g=a.extend({init:function(a,b){"string"==typeof a&&a.match(/^\d+$/)&&(a=+a),void 0===b&&"object"==typeof a&&(b=a,a=void 0),this.id=function(){return a};try{Object.defineProperty(this,"_dirty",{value:0,writable:!0}),Object.defineProperty(this,"_data",{enumerable:!1,configurable:!0,value:b||{},writable:!0})}catch(c){this._dirty=0,this._data=b}},destroy:function(){this.off(),this._data=null},data:function(){return this._dirty!==!0&&(b(f.bind(this,c({},this._data,this._dirty))),this._dirty=!0),this._data},get:function(a){return this._data[a]},set:function(a,c){var d,e=this._data;if(this._dirty||b(f.bind(this)),"string"==typeof a)return this._dirty!==!0&&(this._dirty=this._dirty||{},d in this._dirty||(this._dirty[a]=e[a])),e[a]=c,this;if("object"==typeof a){for(d in a)a.hasOwnProperty(d)&&(this._dirty!==!0&&(this._dirty=this._dirty||{},d in this._dirty||(this._dirty[d]=e[d])),e[d]=a[d]);return this}},toJSON:function(){return this._data}}).mixin(e);return g}),d("nbd/View",["./Class","./trait/pubsub"],function(a,b){"use strict";var c=a.extend({$view:null,render:function(a){var b=this.$view;return this.trigger("prerender",b),this.$view=this.template(a||this.templateData()),b&&b.length&&b.replaceWith(this.$view),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view},template:function(){},templateData:function(){return{}},destroy:function(){this.$view&&this.$view.remove&&this.$view.remove(),this.$view=null,this.off()}}).mixin(b);return c}),d("nbd/View/Entity",["../View"],function(a){"use strict";var b=a.extend({init:function(a){"object"==typeof a&&(this._model=this.Model=a),this.id=a&&a.id||function(){return a}},destroy:function(a){this._model.off(null,null,this),a||(this._model=this.Model=null),this._super()},templateData:function(){return this._model&&this._model.data?this._model.data():this.id()},render:function(a){var b=this.$view,c=!(b&&a);return c&&(this.trigger("prerender",b),this.$view=this.template(this.templateData())),a?this.$view&&this.$view.appendTo(a):b&&b.replaceWith(this.$view),c&&(this.trigger("postrender",this.$view),"function"==typeof this.rendered&&this.rendered(this.$view)),this.$view}});return b}),d("nbd/View/Element",["../View"],function(a){"use strict";var b=a.extend({$parent:null,init:function(a){this.$parent=a},render:function(a){var b=this.$view;return this.trigger("prerender",b),this.$view=this.template(a||this.templateData()),b&&b.length?b.replaceWith(this.$view):this.$view.appendTo(this.$parent),this.trigger("postrender",this.$view),this.rendered&&this.rendered(this.$view),this.$view}});return b}),d("nbd/util/construct",[],function(){"use strict";var a=Object.prototype.toString;return function(){if(!(a.call(this).indexOf("Function")+1))throw new TypeError("construct called on incompatible Object");var b=Object.create(this.prototype),c=this.apply(b,arguments);return Object(c)===c?c:b}}),d("nbd/Controller",["./Class","./util/construct"],function(a,b){"use strict";var c=a.extend({destroy:function(){},_initView:function(a){var c=Array.prototype.slice.call(arguments,1);this._view=this.View=b.apply(a,c),this._view._controller=this._view.Controller=this},switchView:function(){var a=this._view;this._initView.apply(this,arguments),a&&(a.$view&&(this._view.$view=a.$view,this._view.render()),a.destroy())}});return c}),d("nbd/Controller/Entity",["../util/construct","../Controller","../View/Entity","../Model"],function(a,b,c,d){"use strict";var e=b.extend({init:function(){this._model=this.Model=a.apply(this.constructor.MODEL_CLASS,arguments),this._initView(this.constructor.VIEW_CLASS,this._model)},render:function(a,b){b=b||this.constructor.VIEW_CLASS,this.requestView(b),this._view.render(a)},destroy:function(){this._view.destroy(),this._model.destroy(),this._model=this._view=null},requestView:function(a){this._view instanceof a||this.switchView(a,this._model)}},{VIEW_CLASS:c,MODEL_CLASS:d});return e}),d("nbd/event",["./util/extend","./trait/pubsub"],function(a,b){"use strict";var c=a({},b);return c.bind=c.on,c.unbind=c.off,c.fire=c.trigger,c}),d("nbd/trait/promise",["../util/async","../util/extend"],function(a,b){"use strict";function c(){function b(b){b.length&&a(function(){for(var a=0;a<b.length;++a)b[a](h)}),j=k=[]}function d(a){l||(l=1,h=a,b(j))}function e(a){l||(l=-1,h=a,b(k))}function f(a){if(a===i)throw new TypeError("Cannot resolve with self");if(a instanceof c)return a.then(f,e),void 0;try{if(("object"==typeof a||"function"==typeof a)&&null!==a&&"function"==typeof a.then)return function(){var b=!1;try{a.then(function(c){b||((c===a?d:f)(c),b=!0)},function(a){b||(e(a),b=!0)})}catch(c){b||e(c)}}()}catch(b){return e(b),void 0}d(a)}function g(b,d){function e(a){return function(b){var c;try{c=a(b)}catch(d){f.reject(d)}f.resolve(c)}}var f=new c;if(l){var g=l>0?b:d;"function"==typeof g?(g=e(g),a(function(){g(h)})):f[l>0?"resolve":"reject"](h)}else j.push("function"==typeof b?e(b):f.resolve),k.push("function"==typeof d?e(d):f.reject);return f}var h,i=this,j=[],k=[],l=0;Object.defineProperties(this,{reject:{value:e},resolve:{value:f}}),this.then=g}c.prototype.thenable=function(){return{then:this.then}},c.prototype.promise=function(){var a=this.then,b=function(){return c},c={done:function(){var b=Array.prototype.concat.apply([],arguments);return b.forEach(function(b){a(b)}),c},fail:function(){var b=Array.prototype.concat.apply([],arguments);return b.forEach(function(b){a(void 0,b)}),c},then:a,progress:b,promise:b};return c};var d=function(){this._promise||Object.defineProperty(this,"_promise",{value:new c})};return b(c,{then:function(a,b){return d.call(this),this._promise.then(a,b)},resolve:function(a){return d.call(this),this._promise.resolve(a),this},reject:function(a){return d.call(this),this._promise.reject(a),this},thenable:function(){return d.call(this),this._promise.thenable()},promise:function(){return d.call(this),this._promise.promise()}}),c}),d("nbd/util/deparam",[],function(){"use strict";return function(a,b){var c={},d={"true":!0,"false":!1,"null":null};return a.replace(/\+/g," ").split("&").forEach(function(a){var e,f=a.split("="),g=decodeURIComponent(f[0]),h=c,i=0,j=g.split("]["),k=j.length-1;if(/\[/.test(j[0])&&/\]$/.test(j[k])?(j[k]=j[k].replace(/\]$/,""),j=j.shift().split("[").concat(j),k=j.length-1):k=0,2===f.length)if(e=decodeURIComponent(f[1]),b&&(e=e&&!isNaN(e)?+e:"undefined"===e?void 0:void 0!==d[e]?d[e]:e),k)for(i;k>=i;i++)g=""===j[i]?h.length:j[i],h=h[g]=k>i?h[g]||(j[i+1]&&isNaN(j[i+1])?{}:[]):e;else Array.isArray(c[g])?c[g].push(e):c[g]=void 0!==c[g]?[c[g],e]:e;else g&&(c[g]=b?void 0:"")}),c}}),d("nbd/util/media",["./extend","../trait/pubsub"],function(a,b){"use strict";function c(a,b){var c=h(b);g[a]=c,c.addListener(f.bind(c,a)),c.matches&&f.call(c,a)}function d(a){return g[a]&&g[a].matches}function e(a,b){var d;if(!h)throw new Error("Media queries not supported.");if("string"==typeof a)return c(a,b),e;if("object"==typeof a)for(d in a)a.hasOwnProperty(d)&&(b=a[d],c(d,b));return e}var f,g={},h="undefined"!=typeof matchMedia?matchMedia:"undefined"!=typeof msMatchMedia?msMatchMedia:null;return a(e,b),f=function(a){e.trigger(a+(this.matches?":enter":":exit")),e.trigger(a,this.matches)},e.is=d,e.getState=function(a){return a?d(a):Object.keys(g).filter(d)},e}),d("nbd/util/pipe",[],function(){"use strict";return function(){var a=arguments;return function(){var b,c;for(b=0;b<a.length;++b)c=a[b].apply(this,0===b?arguments:[c]);return c}}}),d("nbd/util/protochain",[],function(){"use strict";function a(b,c){var d,e;(e=Object.getPrototypeOf(b))!==Object.prototype&&(a(e,c),c=e.constructor.prototype),d=Object.create(c);for(e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.constructor=b.constructor,b.constructor.prototype=d}return function(b,c,d){if(arguments.length<2)throw new TypeError("Not enough arguments");if("function"!=typeof b)throw new TypeError("First argument must be a constructor");if("function"!=typeof c)throw new TypeError("Second argument must be a constructor");for(var e,f=b.prototype;(e=Object.getPrototypeOf(f))!==Object.prototype;)f=e;if(d!==!0){if(f.__proto__)return f.__proto__=c.prototype,void 0;throw new Error("Cannot modify prototype chain")}a(b.prototype,c.prototype)}}),d("build/all",["nbd/Class","nbd/Model","nbd/View","nbd/View/Entity","nbd/View/Element","nbd/Controller","nbd/Controller/Entity","nbd/event","nbd/trait/promise","nbd/trait/pubsub","nbd/util/async","nbd/util/construct","nbd/util/deparam","nbd/util/diff","nbd/util/extend","nbd/util/media","nbd/util/pipe","nbd/util/protochain"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s={Class:a,Model:b,View:c,Controller:f,event:h,trait:{promise:i,pubsub:j},util:{async:k,construct:l,deparam:m,diff:n,extend:o,media:p,pipe:q,protochain:r}};return s.View.Element=e,s.View.Entity=d,s.Controller.Entity=g,s}),a.nbd=c("build/all")}(this);